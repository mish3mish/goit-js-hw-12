{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(searchValue, page = 1) {\n  const params = new URLSearchParams({\n    key: '47046376-5398f80f14019d8274a22c320',\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page,\n  });\n\n  const imageData = await axios.get(`https://pixabay.com/api/?${params}`);\n  return imageData.data;\n}\n","export function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\" class=\"gallery-item-link\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-item-img\" />\n        <div class=\"gallery-item-content\">\n        <p class=\"gallery-item-description\">Likes<span> ${likes}</span></p>\n        <p class=\"gallery-item-description\">Views<span> ${views}</span></p>\n        <p class=\"gallery-item-description\">Comments<span> ${comments}</span></p>\n        <p class=\"gallery-item-description\">Downloads<span> ${downloads}</span></p>\n        </div>\n        </a>\n      </li>\n      `\n    )\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('.form');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet page = 1;\nlet searchValue = '';\n\nform.addEventListener('submit', handleSubmit);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  searchValue = event.target.search.value.trim(); // removed const\n  console.log(searchValue);\n  if (!searchValue) {\n    iziToast.error({\n      message: 'The field cannot be empty!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  page = 1;\n  gallery.innerHTML = '';\n  loadMoreBtn.classList.add('is-hidden');\n\n  loader.classList.remove('is-hidden');\n  loader.classList.add('is-active');\n\n  await renderImages();\n}\n\nasync function renderImages() {\n  try {\n    const response = await fetchImages(searchValue, page);\n    if (response.totalHits === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please, try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n    gallery.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    if (response.hits.length === 15 && response.totalHits > page * 15) {\n      loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      loadMoreBtn.classList.add('is-hidden');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n    getCardHeight();\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    loader.classList.remove('is-active');\n    loader.classList.add('is-hidden');\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  await renderImages();\n}\n\nfunction getCardHeight() {\n  const galleryItem = document.querySelector('.gallery-item');\n  if (galleryItem) {\n    const rect = galleryItem.getBoundingClientRect();\n    const cardHeight = rect.height;\n\n    if (page > 1) {\n      setTimeout(() => {\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: 'smooth',\n        });\n      }, 300);\n    }\n  }\n}\n"],"names":["fetchImages","searchValue","page","params","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","gallery","form","loader","loadMoreBtn","handleSubmit","handleLoadMore","event","iziToast","renderImages","response","SimpleLightbox","getCardHeight","error","galleryItem","cardHeight"],"mappings":"owBAEO,eAAeA,EAAYC,EAAaC,EAAO,EAAG,CACvD,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAK,qCACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,GACV,KAAAC,CACJ,CAAG,EAGD,OADkB,MAAME,EAAM,IAAI,4BAA4BD,CAAM,EAAE,GACrD,IACnB,CCfO,SAASE,EAAaC,EAAK,CAChC,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,mBAEOL,CAAa;AAAA,oBACZD,CAAY,UAAUE,CAAI;AAAA;AAAA,0DAEYC,CAAK;AAAA,0DACLC,CAAK;AAAA,6DACFC,CAAQ;AAAA,8DACPC,CAAS;AAAA;AAAA;AAAA;AAAA,OAKlE,EACA,KAAK,EAAE,CACZ,CCjBA,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIf,EAAO,EACPD,EAAc,GAElBc,EAAK,iBAAiB,SAAUG,CAAY,EAC5CD,EAAY,iBAAiB,QAASE,CAAc,EAEpD,eAAeD,EAAaE,EAAO,CAIjC,GAHAA,EAAM,eAAc,EACpBnB,EAAcmB,EAAM,OAAO,OAAO,MAAM,KAAI,EAC5C,QAAQ,IAAInB,CAAW,EACnB,CAACA,EAAa,CAChBoB,EAAS,MAAM,CACb,QAAS,6BACT,SAAU,UAChB,CAAK,EACD,MACD,CAEDnB,EAAO,EACPY,EAAQ,UAAY,GACpBG,EAAY,UAAU,IAAI,WAAW,EAErCD,EAAO,UAAU,OAAO,WAAW,EACnCA,EAAO,UAAU,IAAI,WAAW,EAEhC,MAAMM,EAAY,CACpB,CAEA,eAAeA,GAAe,CAC5B,GAAI,CACF,MAAMC,EAAW,MAAMvB,EAAYC,EAAaC,CAAI,EACpD,GAAIqB,EAAS,YAAc,EAAG,CAC5BF,EAAS,MAAM,CACb,QACE,4EACF,SAAU,UAClB,CAAO,EACD,MACD,CACDP,EAAQ,mBAAmB,YAAaT,EAAakB,EAAS,IAAI,CAAC,EAClD,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GACpB,CAAK,EACQ,QAAO,EAEZD,EAAS,KAAK,SAAW,IAAMA,EAAS,UAAYrB,EAAO,GAC7De,EAAY,UAAU,OAAO,WAAW,GAExCA,EAAY,UAAU,IAAI,WAAW,EACrCI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,GAGHI,GACD,OAAQC,EAAO,CACd,QAAQ,IAAIA,EAAM,OAAO,CAC7B,QAAY,CACRV,EAAO,UAAU,OAAO,WAAW,EACnCA,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,CAEA,eAAeG,GAAiB,CAC9BjB,GAAQ,EACR,MAAMoB,EAAY,CACpB,CAEA,SAASG,GAAgB,CACvB,MAAME,EAAc,SAAS,cAAc,eAAe,EAC1D,GAAIA,EAAa,CAEf,MAAMC,EADOD,EAAY,wBACD,OAEpBzB,EAAO,GACT,WAAW,IAAM,CACf,OAAO,SAAS,CACd,IAAK0B,EAAa,EAClB,SAAU,QACpB,CAAS,CACF,EAAE,GAAG,CAET,CACH"}